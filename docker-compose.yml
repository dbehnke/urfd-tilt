services:
  urfd:
    image: urfd
    container_name: urfd
    command: urfd /usr/local/etc/urfd/urfd.ini
    ports:
      # D-Star protocols (all +1 from standard)
      - "30001:30002/udp"  # DExtra (standard 30001, urfd listens on 30002)
      - "20001:20002/udp"  # DPlus (standard 20001, urfd listens on 20002)
      - "30051:30052/udp"  # DCS (standard 30051, urfd listens on 30052)
      # DMR protocols (all +1 from standard)
      - "8880:8881/udp"    # DMRPlus (standard 8880, urfd listens on 8881)
      - "62030:62031/udp"  # MMDVM (standard 62030, urfd listens on 62031)
      # Other protocols (all +1 from standard)
      - "17000:17001/udp"  # M17 (standard 17000, urfd listens on 17001)
      - "42000:42001/udp"  # YSF (standard 42000, urfd listens on 42001)
      - "41000:41001/udp"  # P25 (standard 41000, urfd listens on 41001)
      - "41400:41401/udp"  # NXDN (standard 41400, urfd listens on 41401)
      - "10017:10018/udp"  # URF (standard 10017, urfd listens on 10018)
      # TCP ports
      - "10100:10101/tcp"  # Transcoder (standard 10100, urfd listens on 10101)
      - "40000:40000/tcp"  # G3 Terminal
      - "5555:5555/tcp"    # NNG Dashboard
      # NNG Voice Streams (per-module: A=5556, D=5559, M=5568, S=5574, Z=5581)
      - "5556:5556/tcp"    # Module A - Voice Audio
      - "6556:6556/tcp"    # Module A - Voice Control
      - "5559:5559/tcp"    # Module D - Voice Audio
      - "6559:6559/tcp"    # Module D - Voice Control
      - "5568:5568/tcp"    # Module M - Voice Audio
      - "6568:6568/tcp"    # Module M - Voice Control
      - "5574:5574/tcp"    # Module S - Voice Audio
      - "6574:6574/tcp"    # Module S - Voice Control
      - "5581:5581/tcp"    # Module Z - Voice Audio
      - "6581:6581/tcp"    # Module Z - Voice Control
    volumes:
      - ./config/local:/usr/local/etc/urfd:ro
      - ./data/logs:/var/log/urfd
      - ./data/audio:/usr/local/bin/audio
    restart: unless-stopped

  tcd:
    image: tcd
    container_name: tcd
    command: tcd /usr/local/etc/tcd/tcd.ini
    network_mode: service:urfd
    depends_on:
      - urfd
    volumes:
      - ./config/local:/usr/local/etc/tcd:ro
    restart: unless-stopped

  dashboard:
    image: dashboard
    container_name: dashboard
    command: dashboard -config /etc/dashboard/config.yaml
    ports:
      - "8080:8080/tcp"    # Dashboard HTTP
    environment:
      - URFD_HOST=urfd
    depends_on:
      - urfd
    volumes:
      - ./config/dashboard:/etc/dashboard:ro
      - ./data/audio:/usr/local/bin/audio:ro
      - ./data/dashboard:/app/data
    restart: unless-stopped
