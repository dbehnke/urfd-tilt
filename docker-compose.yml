services:
  urfd:
    image: urfd
    container_name: urfd
    command: urfd /usr/local/etc/urfd/urfd.ini
    ports:
      # D-Star protocols
      - "30001:30001/udp"  # DExtra
      - "20001:20001/udp"  # DPlus
      - "30051:30051/udp"  # DCS
      # DMR protocols
      - "8880:8880/udp"    # DMRPlus
      - "62030:62030/udp"  # MMDVM
      # Other protocols
      - "17000:17000/udp"  # M17
      - "42000:42000/udp"  # YSF
      - "41000:41000/udp"  # P25
      - "41400:41400/udp"  # NXDN
      - "10017:10017/udp"  # URF
      # TCP ports
      - "10100:10100/tcp"  # Transcoder
      - "40000:40000/tcp"  # G3 Terminal
      - "5555:5555/tcp"    # NNG Dashboard
      # NNG Voice Streams (per-module: A=5556, D=5559, M=5568, S=5574, Z=5581)
      - "5556:5556/tcp"    # Module A - Voice Audio
      - "6556:6556/tcp"    # Module A - Voice Control
      - "5559:5559/tcp"    # Module D - Voice Audio
      - "6559:6559/tcp"    # Module D - Voice Control
      - "5568:5568/tcp"    # Module M - Voice Audio
      - "6568:6568/tcp"    # Module M - Voice Control
      - "5574:5574/tcp"    # Module S - Voice Audio
      - "6574:6574/tcp"    # Module S - Voice Control
      - "5581:5581/tcp"    # Module Z - Voice Audio
      - "6581:6581/tcp"    # Module Z - Voice Control
    volumes:
      - ./config/local:/usr/local/etc/urfd:ro
      - ./data/logs:/var/log/urfd
      - ./data/audio:/usr/local/bin/audio
    restart: unless-stopped

  tcd:
    image: tcd
    container_name: tcd
    command: tcd /usr/local/etc/tcd/tcd.ini
    network_mode: service:urfd
    depends_on:
      - urfd
    volumes:
      - ./config/local:/usr/local/etc/tcd:ro
    restart: unless-stopped

  dashboard:
    image: dashboard
    container_name: dashboard
    command: dashboard -config /etc/dashboard/config.yaml
    ports:
      - "8080:8080/tcp"    # Dashboard HTTP
    environment:
      - URFD_HOST=urfd
    depends_on:
      - urfd
    volumes:
      - ./config/dashboard:/etc/dashboard:ro
      - ./data/audio:/usr/local/bin/audio:ro
      - ./data/dashboard:/app/data
    restart: unless-stopped
